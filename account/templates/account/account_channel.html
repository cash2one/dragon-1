{% load staticfiles %}
<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>渠道数据提交</title>
		<link rel="stylesheet" type="text/css" href="{% static 'css/common.css' %}" />
		<link rel="stylesheet" type="text/css" href="{% static 'css/style.css' %}" />
		<link rel="stylesheet" type="text/css" href="{% static 'css/User.css' %}" />
		<link rel="stylesheet" type="text/css" href="{% static 'css/page.css' %}" />
		<link rel="stylesheet" type="text/css" href="{% static 'css/account_channel.css' %}" />
		<script type="text/javascript" src="{% static 'js/jquery-1.11.2.min.js' %}"></script>
		<script type="text/javascript" src="{%static 'js/ajaxfileupload.js'%}"></script>
		<script type="text/javascript" src="{% static 'js/page.js' %}"></script>
	</head>

	<body>
	<!--头部-->
  {% include "header.html" %}
  <!--内容-->
	<div class="Content">
	  <div class="w1100">
	    {% include "account/left.html" %}
			<div class="container-box">
				<div class="content-box">
					<div class="header">
						<h3>选择项目名称</h3>
						<select>
							<option value="渠道项目01">渠道项目01</option>
							<option value="渠道项目02">渠道项目02</option>
							<option value="渠道项目03">渠道项目03</option>
						</select>
						<ul id="tab_head" class="tab-head">
							<li class="on">导入数据</li>
							<li>导出数据</li>
						</ul>
					</div>

					<div class="content-in content">
						<div class="upload-box">
							<input class="download-templete" type="button" value="下载表格模版" />
							<b>支持小于1M的表格文件格式（.xls 和 .xlsx）</b>
							<form id="form" name="form" method="post" action="" enctype="multipart/form-data">
								<input name="userfile" id="choose" type="file" /><br/>
								<p class="table-choosed">已选择表格：<span id="hint" class="hint">未选择任何文件</span></p><br />
								<a class="upload-box-btn" id="upload">导入表格</a><a class="upload-box-btn" id="uploadsubmit">提交表格</a>
							</from>
						</div>
						<h6>注意事项：</h6>
						<p>1、请按项目名称导入数据<br />
						   2、提交的表格需为挖福利提供的表格模版<br />
							3、所有数字需在英文格式下输入<br />
							4、输入日期时，需手动设置单元格格式为“日期”格式，选择“xxxx/xx/xx”类型；<br />
						      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;若投资1万元，只能在表格中填纯数字“10000”，不能填“10000元”或者“1万元”；<br />
						      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;若投资日期为一个月，只能在表格中填纯数字“30”，不能填“30天”或者“1个月”<br />
						5、上传文件大小需小于1M，若导入数据超过上传大小，建议拆分为多个文件再逐个导入</p>
						<div class="img-mask">
						    <div class="loader-inner ball-triangle-path">
						      <div></div>
						      <div></div>
						      <div></div>
						    </div>
						    <p>文件上传中</p>
						</div>
					</div>
					<div class="content-out content" style="display: none;">
						<input class="export-btn" type="button" name="" id="" value="导出审核数据" />
						<h6>注意事项：</h6>
						<p>1、请按项目名称导出数据<br />
						   2、数据自动导出成Excel表格</p>
					</div>
				</div>

				<!--表格展示部分-->
				<div class="Welfare">
					<div class="Welfare-T">
						<strong>理财福利</strong>
						<ul class="Welfare-li" id="Swi-Top">
							<li class="on">全部</li>
							<li>已通过</li>
							<li>审核中</li>
							<li>已拒绝</li>
						</ul>
					</div>
					<div class="Welfare-td">
						<div id="pagedata2">
							<table width="100%">
								<thead>
									<tr>
										<th width="12%">项目</th>
										<th width="10%">投资日期</th>
										<th width="12%">提交手机号</th>
										<th width="8%">投资期限</th>
										<th width="10%">投资金额</th>
										<th width="12%">备注</th>
										<th width="10%">审核结果</th>
										<th width="8%">返现金额</th>
										<th width="18%">拒绝原因</th>
									</tr>
								</thead>
								<tbody>
									<tr><td>美易理财二期</td><td>2017-03-28</td><td>15244659898</td><td>30天</td><td>1000000</td><td>这里是备注</td><td>审核通过</td><td>300</td><td>莉萍说拒绝原因十个字</td></tr>
									<tr><td>美易理财二期</td><td>2017-03-28</td><td>15244659898</td><td>30天</td><td>1000000</td><td>这里是备注</td><td>审核通过</td><td>300</td><td>莉萍说拒绝原因十个字</td></tr>
									<tr><td>美易理财二期</td><td>2017-03-28</td><td>15244659898</td><td>30天</td><td>1000000</td><td>这里是备注</td><td>审核通过</td><td>300</td><td>莉萍说拒绝原因十个字</td></tr>
									<tr><td>美易理财二期</td><td>2017-03-28</td><td>15244659898</td><td>30天</td><td>1000000</td><td>这里是备注</td><td>审核通过</td><td>300</td><td>莉萍说拒绝原因十个字</td></tr>
									<tr><td>美易理财二期</td><td>2017-03-28</td><td>15244659898</td><td>30天</td><td>1000000</td><td>这里是备注</td><td>审核通过</td><td>300</td><td>莉萍说拒绝原因十个字</td></tr>
									<tr><td>美易理财二期</td><td>2017-03-28</td><td>15244659898</td><td>30天</td><td>1000000</td><td>这里是备注</td><td>审核通过</td><td>300</td><td>莉萍说拒绝原因十个字</td></tr>
									<tr><td>美易理财二期</td><td>2017-03-28</td><td>15244659898</td><td>30天</td><td>1000000</td><td>这里是备注</td><td>审核通过</td><td>300</td><td>莉萍说拒绝原因十个字</td></tr>
									<tr><td>美易理财二期</td><td>2017-03-28</td><td>15244659898</td><td>30天</td><td>1000000</td><td>这里是备注</td><td>审核通过</td><td>300</td><td>莉萍说拒绝原因十个字</td></tr>
									<tr><td>美易理财二期</td><td>2017-03-28</td><td>15244659898</td><td>30天</td><td>1000000</td><td>这里是备注</td><td>审核通过</td><td>300</td><td>莉萍说拒绝原因十个字</td></tr>
									<tr><td>美易理财二期</td><td>2017-03-28</td><td>15244659898</td><td>30天</td><td>1000000</td><td>这里是备注</td><td>审核通过</td><td>300</td><td>莉萍说拒绝原因十个字</td></tr>

								</tbody>
							</table>
						</div>
						<div class="Page-in">
							<div class="page" id="page2"><span class="disable">&lt; 上一页</span><span class="on">1</span>
								<a href="javascript:;" class="a_href" data-i="2">2</a>
								<a href="javascript:;" class="a_href" data-i="3">3</a>
								<a href="javascript:;" class="a_href" data-i="4">4</a>
								<a href="javascript:;" class="a_href" data-i="5">5</a>
								<a href="javascript:;" class="a_href" data-i="6">6</a>
								<a href="javascript:;" class="a_href" data-i="7">7</a><span class="dot">...</span>
								<a href="javascript:;" class="a_last">21</a>
								<a href="javascript:;" class="a_next">下一页 &gt;</a><span class="href"><label for="pageText">到第</label><input autocomplete="off" type="text" class="a_text" value="1"><label for="pageText">页</label><input type="button" value="转到" class="a_button"></span></div>
						</div>
					</div>
				</div>
				<div class="popup-box popup-box-01">
				    <div class="popup-content">
				      <h3>表格提交成功</h3>
				      <p id="hint">等待审核中</p>
				      <a id="confirm_submit" class="confirm_submit table-btn" onclick="popupOutSubmit()">确&nbsp;&nbsp;&nbsp;&nbsp;定</a>
				    </div>
				</div>
				<div class="popup-box popup-box-02">
				    <div class="popup-content">
				      <p>提交数据：<span class="data-submit">100</span>项</p>
				      <p>表格重复数据：<span class="data-repeat">100</span>项</p>
				      <p>已存在的数据：<span class="data-exist">100</span>项</p>
				      <p>有效提交：<span class="data-valid">100</span>项</p>
				      <p style="text-align: left;padding-left: 38px;">已提交手机号：<br /><span class="submit-phonenumber">15933827345，15933827345，15933827345，15933827345，15933827345，15933827345，15933827345</span></p>
				      <p style="text-align: left;padding-left: 38px;">注：<br/>
				      	已存在的数据：挖福利数据库中已存在，其他用户或自己之前提交过的数据<br />
				      	表格重复数据：提交的表格中的重复项
				      </p>
				      <a id="upload_again" class="upload-again table-btn" onclick="popupOutMistake()">确&nbsp;&nbsp;&nbsp;&nbsp;定</a>
				      <!-- <a id="look_detail" class="look-detail table-btn" onclick="popupInDetail()">确定</a> -->
				    </div>
				</div>
<!-- 				<div class="popup-box popup-box-03">
				    <div class="popup-content">
				        <h3>重复数据：</h3>
				        <div class="Welfare-td">
							<div id="pagedata2">
								<table width="100%">
									<thead>
										<tr>
											<th width="12%">项目</th>
											<th width="10%">投资日期</th>
											<th width="12%">提交手机号</th>
											<th width="8%">投资期限</th>
											<th width="10%">投资金额</th>
											<th width="12%">备注</th>
											<th width="10%">审核结果</th>
											<th width="8%">返现金额</th>
											<th width="18%">拒绝原因</th>
										</tr>
									</thead>
									<tbody>
										<tr><td>美易理财二期</td><td>2017-03-28</td><td>15244659898</td><td>30天</td><td>1000000</td><td>这里是备注</td><td>审核通过</td><td>300</td><td>莉萍说拒绝原因十个字</td></tr>
										<tr><td>美易理财二期</td><td>2017-03-28</td><td>15244659898</td><td>30天</td><td>1000000</td><td>这里是备注</td><td>审核通过</td><td>300</td><td>莉萍说拒绝原因十个字</td></tr>
										<tr><td>美易理财二期</td><td>2017-03-28</td><td>15244659898</td><td>30天</td><td>1000000</td><td>这里是备注</td><td>审核通过</td><td>300</td><td>莉萍说拒绝原因十个字</td></tr>
									</tbody>
								</table>
							</div>
						</div>
				      <h3>已存在数据：</h3>
				      <div class="Welfare-td">
							<div id="pagedata2">
								<table width="100%">
									<thead>
										<tr>
											<th width="12%">项目</th>
											<th width="10%">投资日期</th>
											<th width="12%">提交手机号</th>
											<th width="8%">投资期限</th>
											<th width="10%">投资金额</th>
											<th width="12%">备注</th>
											<th width="10%">审核结果</th>
											<th width="8%">返现金额</th>
											<th width="18%">拒绝原因</th>
										</tr>
									</thead>
									<tbody>
										<tr><td>美易理财二期</td><td>2017-03-28</td><td>15244659898</td><td>30天</td><td>1000000</td><td>这里是备注</td><td>审核通过</td><td>300</td><td>莉萍说拒绝原因十个字</td></tr>
										<tr><td>美易理财二期</td><td>2017-03-28</td><td>15244659898</td><td>30天</td><td>1000000</td><td>这里是备注</td><td>审核通过</td><td>300</td><td>莉萍说拒绝原因十个字</td></tr>
										<tr><td>美易理财二期</td><td>2017-03-28</td><td>15244659898</td><td>30天</td><td>1000000</td><td>这里是备注</td><td>审核通过</td><td>300</td><td>莉萍说拒绝原因十个字</td></tr>
									</tbody>
								</table>
							</div>
						</div>
						<p style="text-align: left;">注：该页面刷新后将不再显示，有需要的用户请截图保存</p>
				      <a id="confirm_detail" class="confirm-detail table-btn" onclick="popupOutDetail()">确&nbsp;&nbsp;&nbsp;&nbsp;定</a>
				    </div>
				</div> -->
			</div>
		</div>
	</div>
		<!--底部-->
  {% include "footer.html" %}
  <!--浮动窗口-->
  {% include "outline.html" %}

		<script type="text/javascript">
			$('.back-a14').parent().toggleClass("on");
			var filechooser = document.getElementById("choose");
			var upload = document.getElementById("upload");
			var hint = document.getElementById("hint");
			upload.onclick = function() {
					filechooser.click();
				}
			filechooser.onchange =  function() {
				var aa = document.getElementById("choose").value.toLowerCase().split('.');
				if(document.form.userfile.value == "") {
					alert('文件不能为空！');
					return false;
				} else {
					if(aa[aa.length - 1] == 'xls' || aa[aa.length - 1] == 'xlsx') {
						var fileSize = document.getElementById("choose").files[0].size;
						if(fileSize > 1024 * 1024 * 1) {
							alert("文件大小不能超过1M");
							return false;
						} else {
							hint.innerHTML = filechooser.files[0].name;
						}
					} else {
						alert('请选择excel格式文件');
						return false;
					}
				}
			}
			$('a#uploadsubmit').click(function() {
	    		var fileElementId  = 'choose';
	    		if(document.form.userfile.value == ""){
	    			alert("请先选择上传文件");
	    			return;
	    		}
	    		maskIn();
		    	$.ajaxFileUpload({
		            url:'',
		            secureuri:false,
		            fileElementId:fileElementId,//file标签的id
		            dataType: 'json',//返回数据的类型
		            data:{fid:1},//一同上传的数据
		            success: function (data, status) {
		            	$(".img-mask").css("display", "none");
		            	if (data.code==0){
		            		alert(data.dupstr);
		            	}
		            	else {
		            		popupInSubmit();
		            		alert(data.msg);
		            	}
		            },
		            error: function (data, status, e) {
		                popupInMistake();
		                alert(e);
		            }
		        });
	    	});

			//			选项卡切换
			var tabs=document.getElementById("tab_head").getElementsByTagName("li");
			var contents = $('.content');

			for(var i=0;i<contents.length;i++){
				tabs[i].onclick = function(){
					change(this);
				}

			}
			function change(obj){
				for(var i=0;i<tabs.length;i++){
					if(tabs[i]==obj){
						tabs[i].className="on";
						contents[i].style.display = "block";
					}else{
						tabs[i].className="";
						contents[i].style.display = "none";
					}
				}
			}

			$("#Swi-Top li").click(function(){
				if($(this).attr("class")!="on"){
					$(this).toggleClass("on").siblings().removeClass("on")
				}
			});

			// 上传中调用函数
		    function maskIn() {
		        $(".img-mask").css("display", "block");
		    }
		    // 提交成功
		    function popupInSubmit() {
		        $(".popup-box-01").addClass("in");
		    }
			// 提交成功确定
		    function popupOutSubmit() {
		        $(".popup-box-01").removeClass("in");
		    }

		    // 数据异常调用函数
		    function popupInMistake() {
		        $(".popup-box-02").addClass("in");
		    }
			// 再次提交调用函数
		    function popupOutMistake() {
		        $(".popup-box-02").removeClass("in");
		    }

		 //    // 查看详情调用函数
		 //    function popupInDetail() {
		 //    	$(".popup-box-02").removeClass("in");
		 //        $(".popup-box-03").addClass("in");
		 //    }
			// // 详情确认
		 //    function popupOutDetail() {
		 //        $(".popup-box-03").removeClass("in");
		 //    }

		</script>
	</body>

</html>
